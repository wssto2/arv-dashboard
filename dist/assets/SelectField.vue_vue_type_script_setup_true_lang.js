import{d as le,R as ne,S as oe,r as f,j as w,P as ae,b as se,J as ie,G as ue,o as v,m as q,z as re,e as a,c as k,B,q as C,F as j,i as J,f as A,w as G,k as M,U as P,n as ce,v as R,V as W}from"./vendor.js";import{c as fe}from"./CheckboxField.vue_vue_type_script_setup_true_lang.js";import{r as ve}from"./index.js";const de=["disabled","required","value"],pe={class:"select-box-presentation"},me=["innerHTML"],he=["innerHTML"],ye=["onClick"],ke={class:"search-inline"},_e=["name"],be={class:"select-box-results"},ge={class:"select-box-search-container"},Le=["name"],we={class:"select-box-options",ref:"resultsContainer"},Be=["onClick"],Ee=["innerHTML"],Oe={key:0,class:"message"},Ae=le({__name:"SelectField",props:ne({name:{},processing:{type:Boolean,default:!1},label:{},description:{},error:{},required:{type:Boolean,default:!1},editable:{type:Boolean,default:!0},iconBefore:{},iconAfter:{},textAlign:{default:"left"},numeric:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},horizontal:{type:Boolean,default:!1},options:{},optionsValue:{default:"value"},optionsLabel:{default:"label"},multiple:{type:Boolean,default:!1},withoutDefaultOption:{type:Boolean,default:!1},optionsFormatter:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup($){const t=$,u=oe($,"modelValue"),s=f(!1),E=f(!1),y=f([]),_=f([]),O=ve(10),c=f(""),i=f(-1),x=f(null),D=f(null),h=f(null),d=f(null),b=w(()=>t.multiple?!u.value||typeof u.value!="object"||!Array.isArray(u.value)?[]:u.value:u.value===0?null:u.value),F=w(()=>{if(b.value===null)return"";let e=y.value.find(l=>(l==null?void 0:l[t.optionsValue])==b.value);return e?Y(e):""}),K=w(()=>{var e;return(((e=c.value)==null?void 0:e.length)||1)*8+20}),p=w(()=>{if(!c.value)return y.value;const e=c.value.toLowerCase();if(Array.isArray(t.options))return t.options.filter(o=>o[t.optionsLabel].toString().toLowerCase().includes(e));const l={};for(const o in t.options)l[o]=t.options[o].filter(n=>n[t.optionsLabel].toLowerCase().includes(e));return l});function Q(e){return typeof e=="object"&&!Array.isArray(e)}function I(){var e;if(!t.disabled){if(s.value){s.value=!1;return}s.value=!0,t.multiple?(e=h.value)==null||e.focus():W(()=>{var l;(l=d.value)==null||l.focus()})}}function z(e){return t.optionsFormatter?t.optionsFormatter(e):(e==null?void 0:e[t.optionsLabel])||""}function H(e){const l=_.value.indexOf(e);l!==-1&&_.value.splice(l,1)}function X(e){return _.value.includes(e)}function T(e){t.multiple?_.value.includes(e)||_.value.push(e):(u.value=e[t.optionsValue],s.value=!1)}function Y(e){return t.optionsFormatter?t.optionsFormatter(e):e[t.optionsLabel]}function Z(e){return JSON.parse(JSON.stringify(e))}function U(){const e=document.querySelector(".select-box-options .highlighted");e&&e.scrollIntoView({block:"nearest"})}function N(e){s.value&&x.value&&!x.value.contains(e.target)&&(s.value=!1)}function g(e){var l;if(!s.value&&(e.key==="Enter"||e.key==="ArrowDown"||e.key==="ArrowUp"||e.key==="Space")){e.preventDefault(),s.value=!0,t.multiple||W(()=>{var o;(o=d.value)==null||o.focus()});return}if(!(!t.multiple&&!s.value)){if(e.key==="ArrowDown"&&(e.preventDefault(),i.value===null?i.value=0:i.value<p.value.length-1?i.value++:i.value=0,U()),e.key==="ArrowUp"&&(e.preventDefault(),i.value===null?i.value=p.value.length-1:i.value>0?i.value--:i.value=p.value.length-1,U()),e.key==="Enter"){if(e.preventDefault(),i.value>=0&&p.value.length>0)T(p.value[i.value]);else if(p.value.length>0){const o=p.value[0];o&&T(o)}}if(e.key==="Backspace"&&t.multiple&&((l=c.value)==null?void 0:l.length)===0&&(e.preventDefault(),Array.isArray(b.value)&&b.value.length>0)){const o=b.value[b.value.length-1],n=y.value.find(m=>m[t.optionsValue]===o),r=n==null?void 0:n[t.optionsLabel];H(n),c.value=r}e.key==="Escape"&&(e.preventDefault(),s.value=!1),e.key==="Tab"&&(s.value=!1)}}function S(){E.value=!0}function V(){E.value=!1}const ee=w(()=>t.options);ae(ee,()=>{if(c.value="",!t.options.length){y.value=[];return}y.value=Z(t.options),!t.multiple&&!t.withoutDefaultOption&&y.value.unshift({[t.optionsValue]:null,[t.optionsLabel]:"Odaberite..."}),!t.multiple&&!u.value&&t.withoutDefaultOption&&(u.value=y.value[0][t.optionsValue])},{immediate:!0}),se(()=>{var e,l,o,n,r,m,L;t.multiple?((e=h.value)==null||e.addEventListener("keydown",g),(l=h.value)==null||l.addEventListener("focusin",S),(o=h.value)==null||o.addEventListener("focusout",V)):((n=D.value)==null||n.addEventListener("keydown",g),(r=d.value)==null||r.addEventListener("keydown",g),(m=d.value)==null||m.addEventListener("focusin",S),(L=d.value)==null||L.addEventListener("focusout",V)),window.addEventListener("mouseup",N)}),ie(()=>{var e,l,o,n,r,m,L;t.multiple?((e=h.value)==null||e.removeEventListener("keydown",g),(l=h.value)==null||l.removeEventListener("focusin",S),(o=h.value)==null||o.removeEventListener("focusout",V)):((n=D.value)==null||n.removeEventListener("keydown",g),(r=d.value)==null||r.removeEventListener("keydown",g),(m=d.value)==null||m.removeEventListener("focusin",S),(L=d.value)==null||L.removeEventListener("focusout",V)),window.removeEventListener("mouseup",N)});const te=`select_field_${Math.random().toString(36).substring(2,9)}`;return(e,l)=>{const o=ue("icon");return v(),q(fe,{name:t.name,processing:t.processing,label:t.label,description:t.description,error:t.error,required:t.required,editable:t.editable,"addon-left":t.iconBefore,"addon-right":t.iconAfter,horizontal:t.horizontal,value:t.editable?u.value:F.value,"skeleton-style":{left:0,right:0}},{default:re(()=>[a("div",{ref_key:"container",ref:x,class:C(["select-box-container",{open:s.value}])},[a("select",{name:te,disabled:e.disabled,required:e.required,value:u.value},null,8,de),e.multiple?B("",!0):(v(),k("div",{key:0,ref_key:"selection",ref:D,class:C(["select-box-selection","single",{focused:E.value}]),tabindex:"0",onClick:I},[a("span",pe,[e.iconBefore&&u.value?(v(),q(o,{key:0,icon:e.iconBefore,class:"position-left"},null,8,["icon"])):B("",!0),a("span",{innerHTML:F.value},null,8,me)])],2)),e.multiple?(v(),k("div",{key:1,class:C(["select-box-selection","multiple",{focused:E.value}]),onClick:I},[a("ul",null,[(v(!0),k(j,null,J(_.value,(n,r)=>(v(),k("li",{key:`select_${A(O)}_selected_option_${r}`,class:"selected-option"},[a("span",{innerHTML:z(n)},null,8,he),a("a",{class:"remove",onClick:G(m=>H(n),["prevent"])},null,8,ye)]))),128)),a("li",ke,[M(a("input",{ref_key:"multipleSearchInput",ref:h,name:`${A(O)}_multiple_search`,type:"search","onUpdate:modelValue":l[0]||(l[0]=n=>c.value=n),style:ce({width:K.value+"px"}),tabindex:"0",autocorrect:"off",autocapitalize:"off",spellcheck:"false"},null,12,_e),[[P,c.value]])])])],2)):B("",!0),M(a("div",be,[M(a("div",ge,[M(a("input",{ref_key:"resultsSearchInput",ref:d,type:"text",name:`${A(O)}_single_search`,class:"select-box-search","onUpdate:modelValue":l[1]||(l[1]=n=>c.value=n)},null,8,Le),[[P,c.value]])],512),[[R,!e.multiple]]),a("ul",we,[(v(!0),k(j,null,J(p.value,(n,r)=>(v(),k("li",{key:`select_${A(O)}_option_${r}`,class:C([{selected:X(n),highlighted:r===i.value}]),onClick:G(m=>T(n),["prevent"])},[!Q(n)&&e.iconBefore?(v(),q(o,{key:0,icon:e.iconBefore,class:"position-left"},null,8,["icon"])):B("",!0),a("span",{innerHTML:z(n)},null,8,Ee)],10,Be))),128)),p.value.length===0?(v(),k("li",Oe,"No results found")):B("",!0)],512)],512),[[R,s.value]])],2)]),_:1},8,["name","processing","label","description","error","required","editable","addon-left","addon-right","horizontal","value"])}}});export{Ae as _};
