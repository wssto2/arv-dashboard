import{d as T,r as u,P as z,b as A,m as B,z as p,f as t,G as j,o as U,e as l,c as C,h as S,t as K,B as P,g as s,j as N,Q as R,F as E,i as G,w as H}from"./vendor.js";import{u as L,_ as W,a as Z,b as Q}from"./StatusLabel.vue_vue_type_script_setup_true_lang.js";import{j as J,b as X,_ as Y}from"./index.js";import{_ as ee}from"./Modal.vue_vue_type_script_setup_true_lang.js";import{u as te,_ as I,a as q,b as ae}from"./CheckboxField.vue_vue_type_script_setup_true_lang.js";import{_ as f}from"./SelectField.vue_vue_type_script_setup_true_lang.js";import{u as oe}from"./useFetch.js";const le={class:"field-list-group"},se={class:"field-list-group-item"},ie={class:"field-list-group-item"},re={class:"field-list-group-item"},ne={class:"field-list-group-item"},de={class:"field-list-group"},ue={class:"field-list-group-item"},me={class:"field-list-group-item"},pe={class:"field-list-group-item"},_e={class:"field-list-group-item"},ce={class:"field-list-group-item"},ve={class:"field-list-group-item"},fe={class:"field-list-group-item"},be={class:"field-list-group"},ge={class:"field-list-group-item"},ye={class:"field-list-group-item"},Ve={class:"field-list-group"},he={class:"field-list-group-item"},we={class:"field-list-group-item"},xe={class:"flex flex-1 items-center justify-end"},$e={key:0,class:"flex-1"},ke={class:"text-grey-500"},Ie={class:"text-grey-800"},je=T({__name:"VersionModal",props:{categoryId:{},brandId:{},modelId:{}},emits:["save"],setup(D,{expose:h,emit:O}){const i=D,w=O,b=u(),e=te({category_id:i.categoryId,brand_id:i.brandId,model_id:i.modelId}),d=u([]),g=u([]),y=u([]),x=u([]),_=u([]),n=u([]),c=u([]);async function V(){var v;const r=`/definitions/brands/${i.brandId}/models/${i.modelId}/versions/view-options`,a=J(((v=window==null?void 0:window.DASHBOARD_STATE)==null?void 0:v.api_base_url)||"",r),{error:m,data:o}=await oe(a).json();m.value||(d.value=o.value.engine_type||[],g.value=o.value.fuel_type||[],y.value=o.value.engine_class||[],x.value=o.value.gearbox_type||[],_.value=o.value.gearbox_gears||[],n.value=o.value.body_type||[],c.value=o.value.drive_type||[])}z(()=>i.categoryId,()=>{e.originalData.value.category_id=i.categoryId,e.data.value.category_id=i.categoryId}),z(()=>i.brandId,()=>{e.originalData.value.brand_id=i.brandId,e.data.value.brand_id=i.brandId}),z(()=>i.modelId,()=>{e.originalData.value.model_id=i.modelId,e.data.value.model_id=i.modelId});const $=u();function M(r){var a,m;e.reset(),(a=b.value)==null||a.showModal(),(m=$.value)==null||m.focus(),r&&r>0&&e.fetch(`/definitions/brands/${i.brandId}/models/${i.modelId}/versions/${r}`)}h({showModal:M,hideModal:()=>{var r;return(r=b.value)==null?void 0:r.hideModal()}});async function k(){let r=`/definitions/brands/${i.brandId}/models/${i.modelId}/versions`;e.exists()&&(r+=`/${e.getKey()}`),await e.submit({endpoint:r,method:e.exists()?"put":"post"}),w("save")}return A(()=>{V()}),(r,a)=>{const m=j("custom-button");return U(),B(ee,{ref_key:"modal",ref:b,width:800,"dark-body":!0,processing:t(e).processing.value},{header:p(()=>a[15]||(a[15]=[l("h4",{class:"text-bold no-margin"},"Unos / uređivanje verzije",-1)])),footer:p(()=>{var o,v;return[l("div",xe,[t(e).exists()?(U(),C("div",$e,[l("small",ke,[a[20]||(a[20]=S("Zadnja izmjena: ")),l("span",Ie,K(t(X)((o=t(e).data.value)==null?void 0:o.updated_at)),1)])])):P("",!0),s(m,{onClick:(v=b.value)==null?void 0:v.hideModal,class:"mr-10"},{default:p(()=>a[21]||(a[21]=[S("Odustani")])),_:1},8,["onClick"]),s(m,{disabled:t(e).processing.value,appearance:"primary","icon-before":"save",onClick:k,"keyboard-shortcut":{key:"S",ctrlKey:!0}},{default:p(()=>a[22]||(a[22]=[S("Spremi")])),_:1},8,["disabled"])])]}),default:p(()=>[s(t(ae),{processing:t(e).processing.value,horizontal:!0,error:t(e).processingError.value,onSubmit:k},{default:p(()=>[a[16]||(a[16]=l("h6",{class:"text-bold mt-20"},"Osnovne informacije",-1)),l("ul",le,[l("li",se,[s(I,{ref_key:"firstFormField",ref:$,label:"Naziv",required:!0,modelValue:t(e).data.value.name,"onUpdate:modelValue":a[0]||(a[0]=o=>t(e).data.value.name=o),error:t(e).errors.first("name")},null,8,["modelValue","error"])]),l("li",ie,[s(I,{label:"Kod verzije",required:!0,modelValue:t(e).data.value.renault_version_code,"onUpdate:modelValue":a[1]||(a[1]=o=>t(e).data.value.renault_version_code=o),error:t(e).errors.first("renault_version_code")},null,8,["modelValue","error"])]),l("li",re,[s(q,{label:"Naziv verzije razlikuje se u drugim jezicima",modelValue:t(e).data.value.has_translations,"onUpdate:modelValue":a[2]||(a[2]=o=>t(e).data.value.has_translations=o)},null,8,["modelValue"])]),l("li",ne,[s(q,{label:"Aktivno",modelValue:t(e).data.value.active,"onUpdate:modelValue":a[3]||(a[3]=o=>t(e).data.value.active=o)},null,8,["modelValue"])])]),a[17]||(a[17]=l("h6",{class:"text-bold mt-20"},"Specifikacije motora",-1)),l("ul",de,[l("li",ue,[s(f,{label:"Vrsta motora",options:d.value,required:!0,"options-value":"id","options-label":"name",modelValue:t(e).data.value.engine_type_id,"onUpdate:modelValue":a[4]||(a[4]=o=>t(e).data.value.engine_type_id=o),error:t(e).errors.first("engine_type_id")},null,8,["options","modelValue","error"])]),l("li",me,[s(f,{label:"Vrsta goriva",options:g.value,required:!0,"options-value":"id","options-label":"name",modelValue:t(e).data.value.fuel_type_id,"onUpdate:modelValue":a[5]||(a[5]=o=>t(e).data.value.fuel_type_id=o),error:t(e).errors.first("fuel_type_id")},null,8,["options","modelValue","error"])]),l("li",pe,[s(I,{label:"Snaga motora","addon-right":"kW",required:!0,numeric:!0,modelValue:t(e).data.value.engine_power,"onUpdate:modelValue":a[6]||(a[6]=o=>t(e).data.value.engine_power=o),error:t(e).errors.first("engine_power")},null,8,["modelValue","error"])]),l("li",_e,[s(I,{label:"Snaga motora","addon-right":"KS",required:!0,numeric:!0,modelValue:t(e).data.value.engine_power_hp,"onUpdate:modelValue":a[7]||(a[7]=o=>t(e).data.value.engine_power_hp=o),error:t(e).errors.first("engine_power_hp")},null,8,["modelValue","error"])]),l("li",ce,[s(I,{label:"Zapremina motora","addon-right":"ccm",required:!0,numeric:!0,modelValue:t(e).data.value.engine_volume,"onUpdate:modelValue":a[8]||(a[8]=o=>t(e).data.value.engine_volume=o),error:t(e).errors.first("engine_volume")},null,8,["modelValue","error"])]),l("li",ve,[s(f,{label:"Klasa motora",modelValue:t(e).data.value.engine_class_id,"onUpdate:modelValue":a[9]||(a[9]=o=>t(e).data.value.engine_class_id=o),options:y.value,"options-value":"id","options-label":"name",error:t(e).errors.first("engine_class_id")},null,8,["modelValue","options","error"])]),l("li",fe,[s(q,{label:"Plin",modelValue:t(e).data.value.lpg,"onUpdate:modelValue":a[10]||(a[10]=o=>t(e).data.value.lpg=o),error:t(e).errors.first("lpg")},null,8,["modelValue","error"])])]),a[18]||(a[18]=l("h6",{class:"text-bold mt-20"},"Mjenjač",-1)),l("ul",be,[l("li",ge,[s(f,{label:"Vrsta mjenjača",required:!0,modelValue:t(e).data.value.gearbox_type_id,"onUpdate:modelValue":a[11]||(a[11]=o=>t(e).data.value.gearbox_type_id=o),options:x.value,"options-value":"id","options-label":"name",error:t(e).errors.first("gearbox_type_id")},null,8,["modelValue","options","error"])]),l("li",ye,[s(f,{label:"Stupnjevi prijenosa",required:!0,modelValue:t(e).data.value.gearbox_gears_id,"onUpdate:modelValue":a[12]||(a[12]=o=>t(e).data.value.gearbox_gears_id=o),options:_.value,"options-value":"id","options-label":"name",error:t(e).errors.first("gearbox_gears_id")},null,8,["modelValue","options","error"])])]),a[19]||(a[19]=l("h6",{class:"text-bold mt-20"},"Karoserija",-1)),l("ul",Ve,[l("li",he,[s(f,{label:"Karoserija",required:!0,modelValue:t(e).data.value.body_type_id,"onUpdate:modelValue":a[13]||(a[13]=o=>t(e).data.value.body_type_id=o),options:n.value,"options-value":"id","options-label":"name",error:t(e).errors.first("body_type_id")},null,8,["modelValue","options","error"])]),l("li",we,[s(f,{label:"Pogon",required:!0,modelValue:t(e).data.value.drive_type_id,"onUpdate:modelValue":a[14]||(a[14]=o=>t(e).data.value.drive_type_id=o),options:c.value,"options-value":"id","options-label":"name",error:t(e).errors.first("drive_type_id")},null,8,["modelValue","options","error"])])])]),_:1},8,["processing","error"])]),_:1},8,["processing"])}}}),Ue={class:"content"},Me={class:"text-right hidden-xs"},Ce={class:"text-center"},Se={class:"hidden-xs"},Oe={class:"hidden-xs"},ze={class:"text-nowrap"},Ne=["onClick"],qe={href:"#",class:"text-danger"},F="blue",Re=T({__name:"Versions",setup(D){const h=R(),O=N(()=>Number(h.params.categoryId)),i=N(()=>Number(h.params.brandId)),w=N(()=>Number(h.params.modelId)),b={id:{label:"ID",width:50,orderable:!0,align:"right",hideOnMobile:!0},name:{label:"Name",orderable:!0},active:{label:"Status",width:150,align:"center"},created_at:{label:"Created At",width:250,hideOnMobile:!0},updated_at:{label:"Updated At",width:250,hideOnMobile:!0}},e=[{key:"status",icon:"shieldStarFill",label:"Status",type:"select",options:[{label:"Aktivno",value:1},{label:"Neaktivno",value:2}]}],d=L().withURL(`definitions/brands/${i.value}/models/${w.value}/versions`).withColumns(b).withFilters(e).orderBy("name","asc"),g=u([{name:"Administracija"},{name:"Unos vozila"},{name:"Marke",route:{name:"administration.definitions.brands"}}]),y=u();function x(_){var n;(n=y.value)==null||n.showModal(_)}return A(async()=>{var _,n,c,V;await d.fetch(),g.value.push({name:((n=(_=d.meta.value)==null?void 0:_.brand)==null?void 0:n.name)||"Models",route:{name:"administration.definitions.models",params:{brandId:i}}}),g.value.push({name:((V=(c=d.meta.value)==null?void 0:c.model)==null?void 0:V.name)||"Versions",route:{name:"administration.definitions.versions",params:{brandId:i,modelId:w}}})}),(_,n)=>{var k,r,a,m;const c=j("create-button"),V=j("view-header"),$=j("timestamp"),M=j("icon");return U(),C("div",Ue,[s(Y,{items:g.value,class:"mb-20","with-home":!0},null,8,["items"]),s(V,{title:((r=(k=t(d).meta.value)==null?void 0:k.model)==null?void 0:r.name)||"Versions",description:((m=(a=t(d).meta.value)==null?void 0:a.brand)==null?void 0:m.name)||"Here you can manage versions of vehicles that are used when creating new vehicles.",icon:"carWashing",accent:F},{actions:p(()=>{var o;return[s(c,{onClick:(o=y.value)==null?void 0:o.showModal,"keyboard-shortcut":{key:"N",ctrlKey:!0}},{default:p(()=>n[1]||(n[1]=[S("Dodaj verziju")])),_:1},8,["onClick"])]}),_:1},8,["title","description"]),s(t(Q),{collection:t(d),"with-actions":!0,"row-height":64},{default:p(()=>[l("tbody",null,[(U(!0),C(E,null,G(t(d).items(),o=>(U(),C("tr",{key:o.id},[l("td",Me,K(o.id),1),l("td",null,[s(t(W),{onClick:v=>x(o.id),title:o.name,description:o.renault_version_code,"with-decoration":!0,accent:F},null,8,["onClick","title","description"])]),l("td",Ce,[s(Z,{model:o.active},null,8,["model"])]),l("td",Se,[s($,{date:o.created_at},null,8,["date"])]),l("td",Oe,[s($,{date:o.updated_at},null,8,["date"])]),l("td",ze,[l("a",{href:"#",class:"mr-20",onClick:H(v=>x(o.id),["prevent"])},[s(M,{icon:"edit"})],8,Ne),l("a",qe,[s(M,{icon:"delete"})])])]))),128))])]),_:1},8,["collection"]),s(je,{ref_key:"versionModal",ref:y,"category-id":O.value,"brand-id":i.value,"model-id":w.value,onSave:n[0]||(n[0]=o=>t(d).fetch())},null,8,["category-id","brand-id","model-id"])])}}});export{Re as default};
